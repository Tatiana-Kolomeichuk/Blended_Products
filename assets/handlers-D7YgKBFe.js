import{a as i}from"./vendor-EEf_bTFo.js";const T="https://dummyjson.com",m={PRODUCTS:"/products",PRODUCTS_BY_ID:"/products/",CATEGORIES:"/products/category-list",CATEGORY:"products/category/",SEARCH:"/products/search"},a=12,c={QUERY:"",PAGE:1},f="theme",_="cart",n={closeModalBtn:document.querySelector(".modal__close-btn"),modal:document.querySelector(".modal"),body:document.querySelector("body"),themeToggleBtn:document.querySelector(".theme-toggle-btn"),categoriesList:document.querySelector(".categories"),productsList:document.querySelector(".products"),notFoundBlock:document.querySelector("div.not-found"),modalContainer:document.querySelector(".modal-product"),searchForm:document.querySelector(".search-form"),loadMoreBtn:document.querySelector(".load-more-btn")};function h(t,o){try{localStorage.setItem(t,JSON.stringify(o))}catch(r){console.error("Error saving to LocalStorage:",r)}}function E(t){try{const o=localStorage.getItem(t);return o?JSON.parse(o):null}catch(o){return console.error("Error loading from LocalStorage:",o),null}}function R(t){document.body.setAttribute("data-theme",t),document.body.dataset.theme=t,n.themeToggleBtn.innerHTML=t==="light"?"â˜€ï¸":"ðŸŒ™",h(f,t)}function J(){E(f),n.themeToggleBtn.addEventListener("click",()=>{const t=document.body.dataset.theme==="light"?"dark":"light";R(t)})}function L(){n.productsList.innerHTML=""}function M(t){const o=document.querySelector(".categories__btn--active");o&&o.classList.remove("categories__btn--active"),t.classList.add("categories__btn--active")}function b(){n.notFoundBlock.classList.add("not-found--visible")}function v(){n.notFoundBlock.classList.remove("not-found--visible")}function q(){const t=document.querySelector(".categories__btn--active");t&&t.classList.remove("categories__btn--active")}function I(t){Math.ceil(t/a)>c.PAGE?n.loadMoreBtn.classList.remove("is-hidden"):n.loadMoreBtn.classList.add("is-hidden")}function G(){n.loadMoreBtn.classList.add("is-hidden")}function S(){const t=E(_);return Array.isArray(t)?t:[]}function Y(t){h(_,t)}function y(t){const o=document.querySelector("[data-count]"),r=document.querySelector("[data-price]"),e=t.length,s=t.reduce((d,l)=>d+Number(l.price||0),0);o&&(o.textContent=e),r&&(r.textContent=`$${s}`)}i.defaults.baseURL=T;async function P(t){const o=(t-1)*a,{data:r}=await i.get(`${m.PRODUCTS}?limit=${a}&skip=${o}`);return r}async function D(){const{data:t}=await i.get(m.CATEGORIES);return t}async function F(t,o){const r=(o-1)*a,{data:e}=await i.get(`${m.CATEGORY}${t}?limit=${a}&skip=${r}`);return e}async function C(t){const{data:o}=await i.get(`${m.PRODUCTS_BY_ID}${t}`);return o}async function H(){const t=(c.PAGE-1)*a;return(await i.get(`${m.SEARCH}?q=${c.QUERY}&limit=${a}&skip=${t}`)).data}async function u(t){const o=t.map(({thumbnail:r,id:e,description:s,title:d,price:l,category:p,brand:g})=>`<li class="products__item" data-id="${e}">
    <img class="products__image" src="${r}" alt="${s}"/>
    <p class="products__title">${d}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand:${g||"no brand"}</span></p>
    <p class="products__category">Category: ${p}</p>
    <p class="products__price">Price: ${l}$</p>
 </li>`).join("");n.productsList.insertAdjacentHTML("beforeEnd",o)}function O(t){const r=["All",...t].map(e=>`<li class="categories__item">
    <button class="categories__btn" type="button">${e}</button>
    </li>`).join("");n.categoriesList.innerHTML=r}function $(t){const{images:o,title:r,description:e,tags:s,price:d,shippingInformation:l,returnPolicy:p}=t,g=`<img class="modal-product__img" src="${o[0]}" alt="${r}" />
      <div class="modal-product__content">
        <p class="modal-product__title">${r}</p>
        <ul class="modal-product__tags">${s}</ul>
        <p class="modal-product__description">${e}</p>
        <p class="modal-product__shipping-information">Shipping: ${l}</p>
        <p class="modal-product__return-policy">Return Policy: ${p}</p>
        <p class="modal-product__price">Price: ${d}$</p>
        <button class="modal-product__buy-btn" type="button">Buy</button>
      </div>`;n.modalContainer.innerHTML=g}function w(){n.modal.classList.add("modal--is-open"),n.body.style.overflow="hidden",window.addEventListener("keydown",B),n.modal.addEventListener("click",A)}function k(){n.modal.classList.remove("modal--is-open"),n.body.style.overflow="",window.removeEventListener("keydown",B),n.modal.removeEventListener("click",A)}function B(t){t.code==="Escape"&&k()}function A(t){t.currentTarget===t.target&&k()}async function U(t){const o=t.target.closest(".products__item");if(!o)return;const r=o.dataset.id;if(r)try{const e=await getProductById(r);currentProductId=Number(e.id),$(e),N(),w()}catch(e){console.error("Error opening product modal:",e)}}function N(){const t=document.querySelector(".modal-product__btn--wishlist"),o=document.querySelector(".modal-product__btn--cart");!t||!o||currentProductId==null||(t.textContent=isInWishlist(currentProductId)?"Remove from Wishlist":"Add to Wishlist",o.textContent=isInCart(currentProductId)?"Remove from Cart":"Add to Cart")}async function K(){try{const t=await D();O(t);const{products:o}=await P(c.PAGE);u(o)}catch{}}async function V(t){const o=t.target.closest(".categories__btn");if(!o)return;L(),M(o),v(),c.PAGE=1;const r=o.textContent;if(r==="All")try{const{products:e}=await P(c.PAGE);u(e)}catch(e){console.error(`Get products error: ${e}`)}else{c.QUERY=r;try{const{products:e}=await F(c.QUERY,c.PAGE);e.length===0?b():u(e)}catch(e){console.error(`Get products error: ${e}`)}}}async function X(t){const o=t.target.closest(".products__item");if(!o||!n.productsList.contains(o))return;const r=o.dataset.id;if(r)try{const e=await C(r);$(e),w()}catch(e){console.error("ÐÐµ Ð²Ð´Ð°Ð»Ð¾ÑÑ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶Ð¸Ñ‚Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚:",e)}}async function Z(t){t.preventDefault();const r=new FormData(t.target).get("searchValue").trim();if(!r){alert("type something");return}L(),v(),q(),G(),c.QUERY=r,c.PAGE=1;try{const{products:e,total:s}=await H(c.QUERY,c.PAGE);e!=null&&e.length?(u(e),I(s)):b()}catch(e){console.error(`Get product error: ${e}`)}t.target.reset()}async function x(){const t=S();if(!t.length){n.productsList.innerHTML="",n.notFoundBlock.classList.add("not-found--visible"),y([]);return}n.notFoundBlock.classList.remove("not-found--visible");try{const o=await Promise.all(t.map(r=>C(r)));n.productsList.innerHTML="",await u(o),y(o)}catch(o){console.error("Error loading cart products:",o),n.notFoundBlock.classList.add("not-found--visible"),y([])}}function Q(){const t=document.querySelector(".modal-product__btn--wishlist"),o=document.querySelector(".modal-product__btn--cart");if(!t||!o){console.warn("Modal buttons not found in DOM");return}t.addEventListener("click",()=>{}),o.addEventListener("click",async()=>{})}function j(){if(!S().length){iziToast.info({title:"Empty",message:"Your cart is empty.",position:"topRight"});return}iziToast.success({title:"Success",message:"You successfully purchased all products in the cart!",position:"topRight"}),Y([]),x()}function W(){const t=document.querySelector(".scroll-top-btn");t&&(window.addEventListener("scroll",()=>{window.scrollY>300?t.classList.remove("is-hidden"):t.classList.add("is-hidden")}),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}))}function tt(){n.productsList.addEventListener("click",U);const t=document.querySelector(".cart-summary__btn");t&&t.addEventListener("click",j),Q(),W()}export{K as a,Z as b,k as c,x as d,tt as e,V as h,J as i,X as o,n as r};
//# sourceMappingURL=handlers-D7YgKBFe.js.map
