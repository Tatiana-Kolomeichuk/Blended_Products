import{a as u}from"./vendor-EEf_bTFo.js";const M="https://dummyjson.com",g={PRODUCTS:"/products",PRODUCTS_BY_ID:"/products/",CATEGORIES:"/products/category-list",CATEGORY:"products/category/",SEARCH:"/products/search"},d=12,s={QUERY:"",PAGE:1},r={closeModalBtn:document.querySelector(".modal__close-btn"),modal:document.querySelector(".modal"),body:document.querySelector("body"),themeToggleBtn:document.querySelector(".theme-toggle-btn"),categoriesList:document.querySelector(".categories"),productsList:document.querySelector(".products"),notFoundBlock:document.querySelector("div.not-found"),modalContainer:document.querySelector(".modal-product"),searchForm:document.querySelector(".search-form"),loadMoreBtn:document.querySelector(".load-more-btn"),wishlistCountSpan:document.querySelector("[data-wishlist-count]"),cartCountSpan:document.querySelector("[data-cart-count]"),cartSummary:document.querySelector("[data-count]"),cartSummaryPrice:document.querySelector("[data-price]"),cartProductList:document.querySelector(".products"),addToCartModalBtn:document.querySelector(".modal-product__btn--cart"),addTowishlistBtn:document.querySelector(".modal-product__btn--wishlist"),buyBtnCart:document.querySelector(".cart-summary__btn"),modalCloseBtn:document.querySelector(".modal__close-btn"),cartCountSpan:document.querySelector("[data-cart-count]"),wishlistCountSpan:document.querySelector("[data-wishlist-count]")};function l(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(n){console.error("Error saving to LocalStorage:",n)}}function f(t){try{const e=localStorage.getItem(t);return e?JSON.parse(e):null}catch(e){return console.error("Error loading from LocalStorage:",e),null}}function H(t){document.body.hasAttribute("data-theme")?(document.body.removeAttribute("data-theme"),r.themeToggleBtn.textContent="â˜€ï¸",l("theme","light")):(document.body.setAttribute("data-theme","dark"),r.themeToggleBtn.textContent="ðŸŒ™",l("theme","dark"))}function L(){const e=f("theme")==="dark"?"dark":"light";document.body.setAttribute("data-theme",e),document.body.dataset.theme=e,r.themeToggleBtn.textContent=e==="light"?"â˜€ï¸":"ðŸŒ™"}function b(){r.productsList.innerHTML=""}function x(t){const e=document.querySelector(".categories__btn--active");e&&e.classList.remove("categories__btn--active"),t.classList.add("categories__btn--active")}function B(){r.notFoundBlock.classList.add("not-found--visible")}function P(){r.notFoundBlock.classList.remove("not-found--visible")}function D(){const t=document.querySelector(".categories__btn--active");t&&t.classList.remove("categories__btn--active")}function G(t){Math.ceil(t/d)>s.PAGE?r.loadMoreBtn.classList.remove("is-hidden"):r.loadMoreBtn.classList.add("is-hidden")}function F(){r.loadMoreBtn.classList.add("is-hidden")}u.defaults.baseURL=M;async function A(t){const e=(t-1)*d,{data:n}=await u.get(`${g.PRODUCTS}?limit=${d}&skip=${e}`);return n}async function N(){const{data:t}=await u.get(g.CATEGORIES);return t}async function U(t,e){const n=(e-1)*d,{data:o}=await u.get(`${g.CATEGORY}${t}?limit=${d}&skip=${n}`);return o}async function E(t){const{data:e}=await u.get(`${g.PRODUCTS_BY_ID}${t}`);return e}async function O(){const t=(s.PAGE-1)*d;return(await u.get(`${g.SEARCH}?q=${s.QUERY}&limit=${d}&skip=${t}`)).data}async function p(t){const e=t.map(({thumbnail:n,id:o,description:c,title:m,price:y,category:_,brand:C})=>`<li class="products__item" data-id="${o}">
    <img class="products__image" src="${n}" alt="${c}"/>
    <p class="products__title">${m}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand:${C||"no brand"}</span></p>
    <p class="products__category">Category: ${_}</p>
    <p class="products__price">Price: ${y}$</p>
 </li>`).join("");r.productsList.insertAdjacentHTML("beforeEnd",e)}function W(t){const n=["All",...t].map(o=>`<li class="categories__item">
    <button class="categories__btn" type="button">${o}</button>
    </li>`).join("");r.categoriesList.innerHTML=n}function T(t){const{id:e,images:n,title:o,description:c,tags:m,price:y,shippingInformation:_="Standard shipping",returnPolicy:C="30 days return"}=t,R=`
      <img class="modal-product__img" src="${n[0]}" alt="${o}" />
     <div class="modal-product__content data-id="${e}">
        <p class="modal-product__title">${o}</p>
        <ul class="modal-product__tags">${m}</ul>
        <p class="modal-product__description">${c}</p>
        <p class="modal-product__shipping-information">Shipping: ${_}</p>
        <p class="modal-product__return-policy">Return Policy: ${C}</p>
        <p class="modal-product__price">Price: ${y}$</p>
        <button class="modal-product__buy-btn" type="button">Buy</button>
      </div>`;r.modalContainer.innerHTML=R}function v(t){const e=t.length;r.cartSummary.textContent=e;let n=0;for(const o of t)n+=o.price;r.cartSummaryPrice.textContent=n.toFixed(2)}function $(){r.modal.classList.add("modal--is-open"),r.body.style.overflow="hidden",window.addEventListener("keydown",h),r.modal.addEventListener("click",k)}function w(){r.modal.classList.remove("modal--is-open"),r.body.style.overflow="",window.removeEventListener("keydown",h),r.modal.removeEventListener("click",k)}function h(t){t.code==="Escape"&&w()}function k(t){t.currentTarget===t.target&&w()}let a=(f("cartItems")||[]).map(Number),i=(f("wishlist")||[]).map(Number);async function Q(){L();try{const t=await N();W(t);const{products:e}=await A(s.PAGE);p(e)}catch(t){console.error("Failed to initialize home page:",t)}}async function j(t){const e=t.target.closest(".categories__btn");if(!e)return;b(),x(e),P(),s.PAGE=1;const n=e.textContent;if(n==="All")try{const{products:o}=await A(s.PAGE);p(o)}catch(o){console.error(`Get products error: ${o}`)}else{s.QUERY=n;try{const{products:o}=await U(s.QUERY,s.PAGE);o.length===0?B():p(o)}catch(o){console.error(`Get products error: ${o}`)}}}async function V(t){const e=t.target.closest(".products__item");if(!e||!r.productsList.contains(e))return;const n=e.dataset.id;if(n)try{const o=await E(n);T(o),$()}catch(o){console.error("ÐÐµ Ð²Ð´Ð°Ð»Ð¾ÑÑ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶Ð¸Ñ‚Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚:",o)}}async function J(t){t.preventDefault();const n=new FormData(t.target).get("searchValue").trim();if(!n){alert("type something");return}b(),P(),D(),F(),s.QUERY=n,s.PAGE=1;try{const{products:o,total:c}=await O(s.QUERY,s.PAGE);o!=null&&o.length?(p(o),G(c)):B()}catch(o){console.error(`Get product error: ${o}`)}t.target.reset()}//!============================= CART PAGE ================================
async function q(){if(a=(f("cartItems")||[]).map(Number),L(),console.log("Cart IDs from LS:",a),!a.length){r.cartProductList.innerHTML="",r.notFoundBlock.classList.add("not-found--visible"),v([]),S();return}r.notFoundBlock.classList.remove("not-found--visible");try{const t=a.map(n=>E(n)),e=await Promise.all(t);console.log("Loaded cart products:",e),b(),p(e),S(),I(),v(e)}catch(t){console.error("Error loading cart items:",t)}}function I(){const t=i.length;r.wishlistCountSpan&&(r.wishlistCountSpan.textContent=t)}function S(){const t=a.length;r.cartCountSpan.textContent=t}function z(){a=[],l("cartItems",a),q()}async function K(t){const e=t.target.closest("li.products__item");if(!e)return;const n=Number(e.dataset.id);if(n)try{const o=await E(n);T(o),$(),a.includes(n)?r.addToCartModalBtn.textContent="Remove from cart":r.addToCartModalBtn.textContent="Add to cart",i.includes(n)?r.addTowishlistBtn.textContent="Remove from Wishlist":r.addTowishlistBtn.textContent="Add to Wishlist",h()}catch(o){console.error("Error opening product modal:",o)}}function X(){w(),window.removeEventListener("keydown",h)}function Z(t){if(!t.target.closest(".modal-product__actions"))return;const n=r.modalContainer.querySelector("[data-id]");if(!n){console.warn("No product ID found in modal");return}const o=Number(n.dataset.id);console.log("Modal toggling id:",o),a.includes(o)?(a=a.filter(c=>c!==o),t.target.textContent="Add to cart"):(a.push(o),t.target.textContent="Remove from cart"),l("cartItems",a),S(),console.log("Cart after toggle:",a)}function tt(t){const e=t.target.closest(".modal-product__actions");if(!e)return;const n=e.previousElementSibling;if(!n)return;const o=n.querySelector("[data-id]");if(!o)return;const c=Number(o.dataset.id);c&&(console.log("Wishlist toggle id:",c),console.log("Wishlist before:",i),i.includes(c)?(r.addTowishlistBtn.textContent="Add to Wishlist",i=i.filter(m=>m!==c)):(r.addTowishlistBtn.textContent="Remove from Wishlist",i.push(c)),l("wishlist",i),I(),console.log("Wishlist after:",i))}function et(t){if(t.target.textContent!=="Buy")return;const e=t.target.closest(".modal-product__content");if(!e)return;const n=Number(e.dataset.id);a=a.filter(o=>o!==n),l("cartItems",a),r.addToCartModalBtn.textContent="Add to cart",q()}function ot(t){t.preventDefault(),window.location.replace("/index.html");const n=new FormData(t.target).get("searchValue");l("inputValue",n)}export{Q as a,J as b,w as c,q as d,K as e,z as f,X as g,j as h,L as i,Z as j,tt as k,et as l,ot as m,V as o,r,H as t};
//# sourceMappingURL=handlers-BhQ1WPMf.js.map
